범용 UI 시스템 지침서 (다른 제품 적용용)

1. 먼저 채워야 할 “매핑 선언 블록”(필수)
    - 목적: 실제 테이블/필드명이 달라도 동일 UI가 동작하도록, 데이터→UI 키를 선언해 혼선을 방지합니다.
    - 아래 JSON을 가장 위에 작성·확정한 뒤, 모든 규칙에서 이 값을 참조하세요.
    
    { "dataset": { "name": "YOUR_DATASET_NAME", // 예: "Signals", "Trades" "rows_path": "ROOT_ARRAY_PATH", // 예: "signals", "items", "data.list" "id_field": "PRIMARY_ID_FIELD" // 예: "id", "uuid" }, "field_map": { "ticker": "FIELD_NAME_OR_PATH", // 예: "ticker" "recommended_buy_date": "FIELD", // 날짜(ISO/parse가능) "recommended_sell_date": "FIELD", "recommended_buy_price": "FIELD", // 숫자 "recommended_sell_price": "FIELD", "exp_price": "FIELD", // 숫자 "R": "FIELD", // 0~~1 실수 "gap_ratio": "FIELD", // 0~~1 실수 "resolution_rate": "FIELD", // 0~~1 실수 "reliability": "FIELD", // 0~~1 실수 "event_type": "FIELD", // 문자열 "side": "FIELD", // "Long" | "Short" "thesis": "FIELD", "evaluation_method": "FIELD", "risks": "FIELD", // 배열 "source": "FIELD" // 배열 }, "column_catalog": [ // key: 위 field_map의 키 중 택1 또는 커스텀 파생 컬럼 키 // label: 헤더명, width(px): 고정 폭, isDefault: 초기 표시 여부 { "key": "ticker", "label": "종목", "width": 100, "isDefault": true }, { "key": "recommended_buy_date", "label": "매수일", "width": 110, "isDefault": true }, { "key": "recommended_buy_price", "label": "매수가", "width": 100, "isDefault": true }, { "key": "exp_price", "label": "목표가", "width": 100, "isDefault": true }, { "key": "R", "label": "R 점수", "width": 90, "isDefault": true }, { "key": "gap_ratio", "label": "괴리율", "width": 90, "isDefault": true }, { "key": "resolution_rate", "label": "해소율", "width": 90, "isDefault": true }, { "key": "reliability", "label": "신뢰도", "width": 90, "isDefault": true }, { "key": "event_type", "label": "이벤트", "width": 120, "isDefault": true }, { "key": "side", "label": "포지션", "width": 90, "isDefault": true } ], "enums": { "event_type": ["earnings","guidance","product","regulatory","investor_day","mna","pdufa","contract","product_launch","market_shift","other"], "side": ["Long","Short"] }, "formats": { "date_in": "auto", // "auto" 또는 커스텀 파서 규칙 "date_display": "M/d (E)", // 예: 12/11 (수) "currency_prefix": "₩", "percent_R_decimals": 2, "percent_other_decimals": 0 }, "persistence": { "selected_columns_key": "ui.selected_columns", // localStorage 키(또는 서버 프로필 키) "filters_key": "ui.signals_filters", "sort_key": "ui.signals_sort" } }
    
2. 디자인 토큰(전역)
    - CSS 변수
        - -ink #000000, --text #374151, --text-dim #9CA3AF, --surface #F9FAFB, --border #E5E7EB
        - 악센트: --accent-primary #3B82F6, --accent-success #10B981, --accent-warning #F59E0B, --accent-danger #EF4444
    - 스페이싱(8px 그리드)
        - 기본 사용: 8/12/16/24/32px → gap-2/3/4/6/8, p-6, px-4, py-8, md:py-12
    - 타이포그래피
        - h1: text-3xl font-semibold text-[--ink]
        - h2: text-2xl font-bold text-[--ink], h3: text-xl font-semibold text-[--ink]
        - body: text-sm text-[--text], caption: text-xs text-[--text-dim]
        - data: text-3xl font-semibold(카드 숫자), text-lg font-semibold(테이블 강조)
    - Radius/Shadow
        - rounded-lg(8)/xl(12)/2xl(16), hover:shadow-lg transition-shadow duration-200
    - 아이콘 크기
        - 12,14,16,20,24px 사용; 정렬/필터 아이콘은 14px 고정
3. 레이아웃/네비게이션(느낌 유지)
    - 페이지 래퍼: min-h-screen bg-white
    - 컨테이너: narrow max-w-4xl, default max-w-7xl, wide max-w-[1600px]; 공통 패딩 px-4 md:px-6 py-8 md:py-12
    - 상단바: sticky top-0 z-50 bg-white border-b border-[--border] h-16
        - 메뉴 글자: 비활성 text-[--text-dim] hover:text-[--ink], 활성 text-[--ink] font-medium
4. 공통 컴포넌트 규격
    - 버튼
        - Primary: bg-[--ink] text-white hover:bg-gray-800 rounded-lg transition-colors
        - Outline: border border-[--border] text-[--text] hover:bg-[--surface]
        - Ghost: text-[--text-dim] hover:text-[--ink] hover:bg-[--surface]
        - 크기: sm h-8 px-3, md h-10 px-4, lg h-12 px-6; disabled: opacity-50 cursor-not-allowed
    - 입력
        - h-10 px-3 text-sm border border-[--border] rounded-lg focus:ring-2 focus:ring-[--ink] transition-all
        - 소형(필터): h-8 px-3 text-sm
    - 카드/배지/알림
        - 카드: border border-[--border] rounded-xl p-6 bg-white(호버시 shadow-lg)
        - 배지: px-2 py-0.5 text-xs rounded-full(상태색만 교체)
        - 알림: 정보=border-[--border] bg-[--surface], 성공/경고/에러는 연한 테마색
5. 스크롤/오버플로우 규칙
    - 가로 스크롤: 표 부모에 overflow-x-auto
    - 세로 스크롤(헤더 고정): 표 외부 래퍼에 max-height + overflow-y-auto, thead는 sticky top-0 z-10 bg-[--surface]
6. 표 시스템(디자인 스펙, Signals 느낌)
    - 컨테이너: border border-[--border] rounded-xl overflow-hidden bg-white
    - 내부 래퍼: overflow-x-auto
    - table: w-full border-collapse
    - thead(헤더 고정): sticky top-0 z-10 bg-[--surface]
        - th: bg-slate-100/80 backdrop-blur text-[--text-dim] px-4 py-3 text-xs font-medium text-left uppercase tracking-wider whitespace-nowrap, style={{width: column.width}}
        - 헤더 하단 검정 라인: thead 마지막에
    - tbody: divide-y divide-[--border]
    - tr hover: hover:bg-[--surface] transition-colors
    - td: px-4 py-3 text-sm text-[--text] whitespace-nowrap
7. 컬럼 선택 시스템(컴포넌트/상태/동작)
    - 데이터 소스
        - availableColumns = column_catalog(매핑 선언 블록)
        - selectedColumns = 사용자 저장값 존재 시 교차검증 후 사용, 없으면 isDefault=true만 추림
    - UI/UX
        - 트리거: 상단 우측 “컬럼 선택” 버튼(variant=outline size=sm gap-2)
        - 컨텐츠: 체크박스 리스트(세로), 다수일 때 max-h-[300px] overflow-y-auto
        - 토글 시 selectedColumns 즉시 갱신 및 퍼시스트(아래 9항)
    - 표시 컬럼 = availableColumns.filter(c => selectedColumns.includes(c.key))
8. 정렬 시스템(3단 토글+비교 규칙)
    - 상태: sortConfig { key: string|null, direction: 'asc'|'desc'|null }
    - 토글: null → 'asc' → 'desc' → null
    - 비교 함수(컬럼 타입별)
        - date: new Date(a)-new Date(b)
        - string: a.localeCompare(b)
        - number: a-b
    - null/undefined 처리: 항상 끝으로 보냄(asc일 때 뒤, desc일 때 앞)
9. 필터 시스템(타입별 위젯/알고리즘)
    - 타입 판정: getColumnType(key)
        - date: ["recommended_buy_date","recommended_sell_date"]
        - number: ["recommended_buy_price","recommended_sell_price","exp_price","R","gap_ratio","resolution_rate","reliability"]
        - enum: ["event_type","side"]
        - string: 나머지
    - UI
        - 각 th 우측 컨트롤 묶음: flex items-center gap-1
        - 정렬 버튼: p-0.5, 아이콘 14px
        - 필터 버튼(팝오버 트리거): p-0.5, 아이콘 14px; 활성 시 text-[--ink], 비활성 text-[--text-dim]
        - 팝오버: w-64, 내부 space-y-3; 상단에 “라벨/초기화(h-6 px-2 text-xs)”
        - 위젯
            - string: Input(h-8), 포함매칭(소문자 비교)
            - date: Input(type=date,h-8), display ‘yyyy-MM-dd’ 포함 매칭
            - number: 두 필드(최소/최대). 내부 표현 "min-max" 문자열
                - 파싱: minStr,maxStr = split('-'); min=빈→-Infinity, max=빈→Infinity; 숫자 변환 실패 시 제외
            - enum: 단일 옵션 버튼 목록(enums에서 제공), 클릭 시 즉시 적용
    - 필터 적용
        - filters: { [key]: value } 저장
        - 적용 순서: filters의 키 순회하며 누적 AND
        - 초기화: 해당 키 삭제
10. 퍼시스턴스(없으면 로컬 대체)
    - selectedColumns → localStorage[persistence.selected_columns_key]
    - filters → localStorage[persistence.filters_key]
    - sortConfig → localStorage[persistence.sort_key]
    - 서버 저장 가능 시 동일 키명 계약으로 교체
11. 셀 렌더링 규칙(일관 포맷)
    - null/undefined: "-"(색상 text-[--text-dim])
    - 날짜: formats.date_display('M/d (E)')로 렌더(예: 12/11 (수))
    - 통화: formats.currency_prefix + value.toLocaleString()
    - 퍼센트
        - R: ((v||0)*100).toFixed(formats.percent_R_decimals)+'%' (굵게, text-[--ink])
        - gap_ratio/resolution_rate/reliability: ((v||0)*100).toFixed(formats.percent_other_decimals)+'%'
    - side 배지: px-2 py-0.5 text-xs rounded-full; Long=bg-blue-100 text-blue-700, Short=bg-red-100 text-red-700, 그 외=bg-gray-100 text-gray-700
    - event_type 칩: text-xs px-2 py-1 rounded-full bg-[--surface] text-[--text]
    - 배열(risks/source): "text-xs text-[--text-dim]"로 “N개 리스크/출처”
    - 긴 텍스트(thesis/evaluation_method/agent_version): text-xs text-[--text] truncate max-w-[200px] + title=전체값
12. 헤더 고정·스크롤 명시(요청사항 강조)
    - 세로 스크롤 시: 표 바깥 래퍼에 max-height + overflow-y-auto를 적용하고, thead에 sticky top-0 z-10 bg-[--surface]를 적용해 “헤더는 고정, 행만 스크롤”을 보장합니다.
    - 가로 스크롤 시: 표 부모에 overflow-x-auto로 수평 스크롤, 헤더 고정 유지.
13. 잠금(옵션 기능을 쓰는 경우)
    - 행 전체 잠금: tr에 opacity-60
    - 잠긴 셀: 중앙에 잠금 아이콘(12px, 색 text-[--text-dim]) 표시
    - 항상 공개 예외 컬럼: ticker, recommended_buy_date
14. 수용성·접근성
    - 모든 상호작용 요소 focus:ring-2 focus:ring-[--ink]
    - 정렬/필터 버튼 aria-label 제공(“정렬”, “필터”)
    - 팝오버는 ESC로 닫기, 탭 이동 가능
15. 수용 테스트 체크리스트
    - [ ]  토큰/타이포/간격/테두리/그림자 일치
    - [ ]  상단바/컨테이너 폭·패딩 일치
    - [ ]  표 컨테이너/thead sticky/검정 라인/행 hover/셀 패딩 정확
    - [ ]  column_catalog→availableColumns 반영, selectedColumns 퍼시스트
    - [ ]  정렬 토글(무→오름→내림→무) 및 타입별 비교 정확
    - [ ]  필터 위젯 타입/파싱(문자/날짜/범위/enum) 정확, 다중 AND
    - [ ]  가로/세로 스크롤 시 헤더 고정 동작
    - [ ]  null/undefined/긴 텍스트/배열 렌더링 규칙 일치
    - [ ]  아이콘 14px(정렬/필터), 16px(버튼) 규격 일치